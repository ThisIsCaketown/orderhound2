angular.module("app",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("login",{url:"/login",templateUrl:"./app/routes/login/login.html",controller:"loginCtrl"}).state("home",{url:"/home",templateUrl:"./app/routes/home/home.html",controller:"homeCtrl",resolve:{user:["mainService","$state",function(t,e){return t.getCurrentUser().then(function(t){return t.data.email?t.data:e.go("login")}).catch(function(t){e.go("login")})}]}}).state("adminHome",{url:"/adminHome",templateUrl:"./app/routes/adminHome/adminHome.html",controller:"adminHomeCtrl",resolve:{user:["mainService","$state",function(t,e){return t.getCurrentUser().then(function(t){return t.data.email?t.data:e.go("login")}).catch(function(t){e.go("login")})}]}}),e.otherwise("/login")}]),angular.module("app").service("mainService",["$http",function(t){this.login=function(e){return t({method:"post",url:"/api/login",data:e}).then(function(t){return t})},this.logout=function(){return t({method:"get",url:"/api/logout"}).then(function(t){return t})},this.getCurrentUser=function(){return t({method:"GET",url:"/api/me"}).then(function(t){return t})},this.register=function(e){return t({method:"POST",url:"/api/register",data:e}).then(function(t){return t})}}]),angular.module("app").controller("homeCtrl",["$scope","$state","mainService","homeService","user",function(t,e,n,o,r){t.user=r,t.addpo=function(t){o.addpo(t).then(function(t){alert("PO added successfully")})},t.login=function(o){n.login(o).then(function(n){return n.data?("true"===n.data.admin?e.go("adminHome"):e.go("home"),void console.log(n.data.admin)):(t.user.password="",alert("user could not be logged in"))}).catch(function(e){t.user.password="",alert("user could not be logged in")})},t.logout=function(){n.logout().then(function(t){e.go("login")})}}]),angular.module("app").service("homeService",["$http",function(t){this.addpo=function(e){return t({method:"POST",url:"/api/checkin",data:{ponumber:e,checkpoint_id:1}}).then(function(t){return t.data})},this.findpo=function(e){return t({method:"POST",url:"/api/find",data:{ponumber:e}}).then(function(t){return t.data})}}]),angular.module("app").controller("adminHomeCtrl",["$scope","mainService","user","$state",function(t,e,n,o){t.user=n,t.logout=function(){e.logout().then(function(t){o.go("login")})}}]),angular.module("app").controller("loginCtrl",["$scope","mainService","$state",function(t,e,n){t.test="login",t.login=function(o){e.login(o).then(function(e){return e.data?("true"===e.data.admin?n.go("adminHome"):n.go("home"),void console.log(e.data.admin)):(t.user.password="",alert("user could not be logged in"))}).catch(function(e){t.user.password="",alert("user could not be logged in")})},t.register=function(t){e.register(t).then(function(t){return"User created successfully!"!==t.data?alert("Could not register user"):void alert(t.data)}).catch(function(t){return alert("Could not register user")})}}]);